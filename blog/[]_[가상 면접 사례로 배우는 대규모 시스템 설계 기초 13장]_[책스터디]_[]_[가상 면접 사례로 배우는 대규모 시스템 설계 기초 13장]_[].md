# 13장 검색어 자동완성 시스템

### 1단계 문제 이해 및 설계 범위 확정

- 사용자가 입력하는 단어는 자동완성될 검색어의 첫 부분
- 표시되는 검색어는 5개
- 질의 빈도에 따라 정해지는 검색어 인기 순위 정렬
- 맞춤법 검사나 자동수정 지원 X
- 다국어 지원
- 모든 질의는 영어 소문자로 가정
- DAU 천만명

#### 요구사항

- 빠른 응답 속도 : 100밀리초 이내
- 연관성 : 사용자가 입력한 단어와 연관될 것
- 정렬 : 인기도 등의 순위 모델에 의해 정렬
- 규모 확장성 : 트래픽을 감당할 수 있도록 확장 가능
- 고가용성 : 일부 장애 발생, 느려지거나, 예상치 못한 네트워크 문제가 생겨도 시스템은 계속 사용 가능

#### 래걀적 규모 추정

- DAU 천만 명
- 사용자는 매일 10건 검색 수행
- 평균 20바이트의 데이터 입력
  - 문자 인코딩 ASCII 사용, 1문자 = 1바이트
  - 질의문은 평균적으로 4개 단어로 이루어진다고 가정, 각 단어는 평균적으로 다섯 글자로 구성된다 가정
  - 질의당 평균 4 * 5 = 20바이트
- 글자 입력 때마다 클라이언트는 검색어 자동완성 백엔드에 요청, 검색당 20건의 요청 전송
- 대략 초당 24,000건의 질의 발생 (10,000,000 * 10 * 20/24/3600)
- 질의 가운데 20% 정도는 신규 검색어, 매일 0.4GB 신규 데이터 추가 (10,000,000 * 10 * 20 * 0.2)

### 2단계 개략적 설계안 제시 및 동의 구하기

- 데이터 수집 서비스 : 사용자가 입력한 질의를 실시간으로 수집하는 시스템, 데이터가 많은 애플리케이션에 실시간 시스템은 그다지 바람지하지 않음
- 질의 서비스 : 주어진 질의 5개의 인기 검색어를 정렬해 내놓은 서비스

#### 데이터 수집 서비스


